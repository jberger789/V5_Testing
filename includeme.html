
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>V5_Testing &#8212; V5_Testing Scripts  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to V5_Testing Scripts’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="v5-testing">
<h1>V5_Testing<a class="headerlink" href="#v5-testing" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="module-temp_data_shifter">
<span id="temperature-data-shifter"></span><h1>Temperature Data Shifter<a class="headerlink" href="#module-temp_data_shifter" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="temp_data_shifter.convert_row">
<code class="sig-prename descclassname">temp_data_shifter.</code><code class="sig-name descname">convert_row</code><span class="sig-paren">(</span><em class="sig-param">row</em><span class="sig-paren">)</span><a class="headerlink" href="#temp_data_shifter.convert_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in a single row of temperature data from <strong>TEMPS_DB</strong> and converts it to two rows of temperature data to be inserted into <em>TEMPERATURES</em> in <strong>RESULTS_DB</strong></p>
<dl class="simple">
<dt><strong>Parameters</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">row</span></code></dt><dd><p>A dictionary representing the row retrieved from <strong>TEMPS_DB</strong>.
Assumes the row was retrieved successfully</p>
</dd>
</dl>
</dd>
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">out_rows</span></code></dt><dd><p>A list containing the two newly converted rows</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="temp_data_shifter.insert_ignore_many_query">
<code class="sig-prename descclassname">temp_data_shifter.</code><code class="sig-name descname">insert_ignore_many_query</code><span class="sig-paren">(</span><em class="sig-param">table</em>, <em class="sig-param">rows</em><span class="sig-paren">)</span><a class="headerlink" href="#temp_data_shifter.insert_ignore_many_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an appropriate string for inserting potentially duplicate rows into an SQL table.</p>
<dl class="simple">
<dt><strong>Parameters</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">table</span></code></dt><dd><p>The name of an SQL table in the current database.
Assumes a table with that name exists in the database as defined by <strong>RESULTS_DB</strong></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rows</span></code></dt><dd><p>a list of rows to insert into <code class="docutils literal notranslate"><span class="pre">table</span></code>.
Assumes every row dictionary contains corresponding values for every data column in the table</p>
</dd>
</dl>
</dd>
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">query_str</span></code></dt><dd><p>A string representing an SQL statement that, if executed, performs an <em>INSERT IGNORE</em> of every row in <code class="docutils literal notranslate"><span class="pre">rows</span></code> into <code class="docutils literal notranslate"><span class="pre">table</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="temp_data_shifter.round_time">
<code class="sig-prename descclassname">temp_data_shifter.</code><code class="sig-name descname">round_time</code><span class="sig-paren">(</span><em class="sig-param">tm_str</em><span class="sig-paren">)</span><a class="headerlink" href="#temp_data_shifter.round_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a string representation of the values in many rows, formatted for an SQL query.</p>
<dl>
<dt><strong>Parameters</strong>:</dt><dd><dl>
<dt><code class="docutils literal notranslate"><span class="pre">tm_str</span></code></dt><dd><p>A string containing a representation of a <code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code> object in standard format.</p>
<p>Standard format is defined as “YYYY-MM-DD hh:mm:ss(:[msecs])”</p>
</dd>
</dl>
</dd>
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">new_tm</span></code></dt><dd><p>A <code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code> object, containing the timestamp from <code class="docutils literal notranslate"><span class="pre">tm_str</span></code> rounded to the nearest ten second mark</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="temp_data_shifter.rowvals4SQLmany">
<code class="sig-prename descclassname">temp_data_shifter.</code><code class="sig-name descname">rowvals4SQLmany</code><span class="sig-paren">(</span><em class="sig-param">row_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temp_data_shifter.rowvals4SQLmany" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a string representation of the values in many rows, formatted for an SQL query.</p>
<dl class="simple">
<dt><strong>Parameters</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">row_list</span></code></dt><dd><p>A list containing the rows (as dictionaries) to be inserted.
Assumes every row dictionary contains corresponding values for every data column in the table</p>
</dd>
</dl>
</dd>
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">out_str</span></code></dt><dd><p>A string containing strings generated by <code class="xref py py-meth docutils literal notranslate"><span class="pre">rowwvals4SQLquery()</span></code> for each row in <code class="docutils literal notranslate"><span class="pre">row_list</span></code>, separated by commas</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="temp_data_shifter.rowvals4SQLquery">
<code class="sig-prename descclassname">temp_data_shifter.</code><code class="sig-name descname">rowvals4SQLquery</code><span class="sig-paren">(</span><em class="sig-param">row</em><span class="sig-paren">)</span><a class="headerlink" href="#temp_data_shifter.rowvals4SQLquery" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a string representation of the values in <code class="docutils literal notranslate"><span class="pre">row</span></code>, formatted for an SQL query.</p>
<dl class="simple">
<dt><strong>Parameters</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">row</span></code></dt><dd><p>The dictionary representing the row.
Assumes the dictionary contains corresponding values for every data column in the table</p>
</dd>
</dl>
</dd>
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">row_str</span></code></dt><dd><p>A string containing comma separated values from <code class="docutils literal notranslate"><span class="pre">row</span></code>, enclosed in parentheses</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="temp_data_shifter.temp_shifter">
<code class="sig-prename descclassname">temp_data_shifter.</code><code class="sig-name descname">temp_shifter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temp_data_shifter.temp_shifter" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in temperature data from the database as defined by <strong>TEMPS_DB</strong>,
rounds their timestamps to the nearest 10 seconds, and inserts it into the
<em>TEMPERATURES</em> table in the database as defined by <strong>RESULTS_DB</strong>.</p>
<dl class="simple">
<dt><strong>Assumes</strong>:</dt><dd><ul class="simple">
<li><p>Both databases exist as defined</p></li>
<li><p>The row in <em>TESTS</em> with the time interval containing the data to be shifted exists</p></li>
<li><p>the tables in both databases exist and are formatted as expected</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-optimized_parsing">
<span id="parser"></span><h1>PARSER<a class="headerlink" href="#module-optimized_parsing" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="optimized_parsing.make_datetime">
<code class="sig-prename descclassname">optimized_parsing.</code><code class="sig-name descname">make_datetime</code><span class="sig-paren">(</span><em class="sig-param">match_obj</em><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.make_datetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a match object that contains groups with date/time info, return a corresponding python datetime object</p>
</dd></dl>

<dl class="function">
<dt id="optimized_parsing.return_or">
<code class="sig-prename descclassname">optimized_parsing.</code><code class="sig-name descname">return_or</code><span class="sig-paren">(</span><em class="sig-param">val_list</em><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.return_or" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt><strong>Parameters</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">val_list</span></code></dt><dd><p>A list of values <code class="docutils literal notranslate"><span class="pre">[v1,...,vn]</span></code></p>
</dd>
</dl>
</dd>
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">or_str</span></code></dt><dd><p>The string <code class="docutils literal notranslate"><span class="pre">&quot;((v1)|...|(vn))&quot;</span></code>, which is formatted appropriately for use in an <code class="docutils literal notranslate"><span class="pre">or</span></code> statement in a regular expression</p>
</dd>
</dl>
</dd>
</dl>
<p><strong>Example</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">return_or</span><span class="p">([</span><span class="s1">&#39;tea&#39;</span><span class="p">,</span><span class="s1">&#39;milk&#39;</span><span class="p">,</span><span class="s1">&#39;coffee&#39;</span><span class="p">])</span>
<span class="c1"># Returns</span>
<span class="s2">&quot;((tea)|(milk)|(coffee))&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="optimized_parsing.rowcols4SQLquery">
<code class="sig-prename descclassname">optimized_parsing.</code><code class="sig-name descname">rowcols4SQLquery</code><span class="sig-paren">(</span><em class="sig-param">cols</em>, <em class="sig-param">id_cols=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.rowcols4SQLquery" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a string representation of the values in cols, formatted for
an SQL query (where the values are the column names of the table.</p>
<dl>
<dt><strong>Parameters</strong>:</dt><dd><dl>
<dt><code class="docutils literal notranslate"><span class="pre">cols</span></code></dt><dd><p>A list containing the column names as strings</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">id_cols</span></code></dt><dd><p>A list containing the column names used for identification purposes, and which will not normally be contained in the row dictionary</p>
<p>In most instances this list will be equal to <code class="docutils literal notranslate"><span class="pre">['time_stamp','unit','side']</span></code>, since these
columns’ values are extracted separately from the rest of the row data</p>
<p>By default, this parameter is set to an empty list</p>
</dd>
</dl>
</dd>
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">col_str</span></code></dt><dd><p>A string containing comma separated values from <code class="docutils literal notranslate"><span class="pre">id_cols</span></code> and <code class="docutils literal notranslate"><span class="pre">cols</span></code>, enclosed in parentheses</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="optimized_parsing.rowvals4SQLmany">
<code class="sig-prename descclassname">optimized_parsing.</code><code class="sig-name descname">rowvals4SQLmany</code><span class="sig-paren">(</span><em class="sig-param">row_list</em>, <em class="sig-param">col_dict</em>, <em class="sig-param">id_cols=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.rowvals4SQLmany" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a string representation of the values in many rows, formatted for an SQL query.</p>
<dl>
<dt><strong>Parameters</strong>:</dt><dd><dl>
<dt><code class="docutils literal notranslate"><span class="pre">row_list</span></code></dt><dd><p>A list containing the rows (as dictionaries) to be inserted.
Assumes every row dictionary contains corresponding values for every data column in the table</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">col_dict</span></code></dt><dd></dd>
<dt><code class="docutils literal notranslate"><span class="pre">id_cols</span></code></dt><dd><p>A list containing the column names used for identification purposes, and which will not normally be contained in the row dictionary</p>
<p>In most instances this list will be equal to <code class="docutils literal notranslate"><span class="pre">['time_stamp','unit','side']</span></code>, since these
columns’ values are extracted separately from the rest of the row data</p>
<p>By default, this parameter is set to an empty list</p>
</dd>
</dl>
</dd>
<dt><strong>Returns</strong>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">out_str</span></code></dt><dd><p>A string ????</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="optimized_parsing.Log">
<em class="property">class </em><code class="sig-prename descclassname">optimized_parsing.</code><code class="sig-name descname">Log</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">units</em><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.Log" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="optimized_parsing.Log.add_test">
<code class="sig-name descname">add_test</code><span class="sig-paren">(</span><em class="sig-param">test</em><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.Log.add_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Associate a new test with this log.</p>
<p>Attempts to set up a new table in the database for
storing data from this test. After it has done so, or
if such a table already exists, this method adds the
new test to the test dictionary <code class="docutils literal notranslate"><span class="pre">self.tests</span></code>, where the
key is the string equivalent to this test’s tag (<code class="docutils literal notranslate"><span class="pre">test.tag</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test</strong> (<a class="reference internal" href="#optimized_parsing.Test" title="optimized_parsing.Test"><em>Test</em></a><em>(</em><em>)</em>) – The test object to be added to this log</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>May raise errors when attempting to create a
new table, as there is no available way to
specify the length of an SQL string type</p>
</div>
</dd></dl>

<dl class="method">
<dt id="optimized_parsing.Log.extract_data">
<code class="sig-name descname">extract_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.Log.extract_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts test results from the log file.</p>
<p>For each line in the log file, checks if it has a relevant <cite>prefix</cite>.
If it does, then it runs calls parse_line() on the line to attempt
to convert data from the line into a row to be inserted into the database.
When it recieves the list of rows to be inserted, it then attempts to insert
them into the corresponding test table in the database, using a query string
generated by insert_ignore_many_query(), in order to ensure that duplicate
entries are not inserted.</p>
</dd></dl>

<dl class="method">
<dt id="optimized_parsing.Log.get_line_count">
<code class="sig-name descname">get_line_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.Log.get_line_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of lines in the log file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of lines in the file with the name <code class="docutils literal notranslate"><span class="pre">self.message_file_name</span></code></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>IOError</strong> – The file with the name <code class="docutils literal notranslate"><span class="pre">self.message_file_name</span></code> could not be opened</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="optimized_parsing.Log.parse_line">
<code class="sig-name descname">parse_line</code><span class="sig-paren">(</span><em class="sig-param">line</em>, <em class="sig-param">cur_test</em>, <em class="sig-param">recur_count=0</em><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.Log.parse_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts data from a log message into a row to insert into an SQL table.</p>
<p>Given a log message line and the test the line is associated with, attempts
to interpret the data in the line into a row dictionary.</p>
<p>The exact interpretation process is dependant on the individual test, but in
general it attemps to match the line to a regular expression corresponding
to the current test’s output format, and then uses the groups found by the
regular expression, along with the variables specified in the test’s
<code class="docutils literal notranslate"><span class="pre">data_info</span></code> attribute to populate a row dictionary with the data.</p>
<p>For tests that do (or may) have multiple lines of data for a single test result
(and thus a single row of data), will also check and attempt to parse the
following lines as specified by the attributes of <code class="docutils literal notranslate"><span class="pre">cur_test</span></code>.</p>
<p>After successfully filling a dictionary for a full row of data for the
current test, will call itself recursively on the next line in the log file,
under the assumption that the next line also belongs to the same test.  This
continues until it either reaches the end of the lines associated with the
current test, or it exceeds python’s recursion limit. This allows it to return
a list of rows to be inserted into a single table with one query, which is
much faster than inserting each row individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line</strong> (<em>str</em>) – A string containing a single line from the log file, which presumable contains
a log message generated by the test denoted in <code class="docutils literal notranslate"><span class="pre">cur_test</span></code></p></li>
<li><p><strong>cur_test</strong> (<a class="reference internal" href="#optimized_parsing.Test" title="optimized_parsing.Test"><em>Test</em></a><em>(</em><em>)</em>) – The test object that is expected to correspond to the test results contained in line</p></li>
<li><p><strong>recur_count</strong> (<em>int</em>) – Stores current recursion depth, to avoid raising an error if the limit is reached
Set to <code class="docutils literal notranslate"><span class="pre">0</span></code> by default if no value is specified.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of <cite>row</cite> dictionaries.  Every row in the list is associated with the same test.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="optimized_parsing.Log.set_re_prefix">
<code class="sig-name descname">set_re_prefix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.Log.set_re_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the regular expression for the <cite>prefix</cite>.</p>
<p>The <cite>prefix</cite> is the part of the log message that contains
the time stamp, the unit and side, and the test tag.
The regular expression for matching the <cite>prefix</cite> is as
such dependent on which units were tested and which
tests were performed during the test run that the log
file contains results from. The <cite>prefix</cite> makes it possible
to determine if a log message came from a test or not,
thus quickly ruling out some irrelevant log messages,
and making it possible to determine which test the log
messsage may have come from.</p>
</dd></dl>

<dl class="method">
<dt id="optimized_parsing.Log.show_progress">
<code class="sig-name descname">show_progress</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.Log.show_progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the current progress in parsing the log file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="optimized_parsing.Test">
<em class="property">class </em><code class="sig-prename descclassname">optimized_parsing.</code><code class="sig-name descname">Test</code><span class="sig-paren">(</span><em class="sig-param">json_file_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#optimized_parsing.Test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">V5_Testing Scripts</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">V5_Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-temp_data_shifter">Temperature Data Shifter</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-optimized_parsing">PARSER</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to V5_Testing Scripts’s documentation!</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Joshua Berger, Jack Tillman, Gabe Sauvageau.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/includeme.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>